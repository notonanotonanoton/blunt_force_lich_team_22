[gd_scene load_steps=4 format=3 uid="uid://cupv7wvlaedxn"]

[ext_resource type="Texture2D" uid="uid://dfg63drc2dpj5" path="res://physics_objects/character_phylactery.png" id="1_ifsfx"]

[sub_resource type="PhysicsMaterial" id="PhysicsMaterial_78kp0"]
friction = 0.83
rough = true
absorbent = true

[sub_resource type="GDScript" id="GDScript_ovx2o"]
script/source = "extends RigidBody2D

var held
var first_sender
var collision_shape : CollisionPolygon2D

# Called when the node enters the scene tree for the first time.
func _ready():
	collision_shape = get_node(\"CollisionPolygon2D\") as CollisionPolygon2D


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _physics_process(delta):
	if held:
		self.global_transform.origin = ((first_sender.global_position)-Vector2(0, 20))


func pick_up(sender):
	if first_sender == null:
		first_sender = sender
		set_deferred(\"freeze\", true)
		held = true
		disable_collision()


func throw(sender):
	if held:
		held = false;
		enable_collision()
		first_sender = null;
		set_deferred(\"freeze\", false)
		if sender.looking_direction == 1:
			send_right.call_deferred()
		else:
			send_left.call_deferred()
	
	
func disable_collision()-> void:
	collision_shape.set_deferred(\"disabled\", true)

func enable_collision() -> void:
	collision_shape.set_deferred(\"disabled\", false)

func send_right() -> void:
	apply_central_impulse(Vector2(500, -500))

func send_left() -> void:
	apply_central_impulse(Vector2(-500, -500))
"

[node name="pick_up_box" type="RigidBody2D"]
collision_layer = 5
mass = 2.0
physics_material_override = SubResource("PhysicsMaterial_78kp0")
lock_rotation = true
freeze_mode = 1
continuous_cd = 2
max_contacts_reported = 5
contact_monitor = true
script = SubResource("GDScript_ovx2o")

[node name="Sprite2D" type="Sprite2D" parent="."]
position = Vector2(0, 5.36442e-07)
texture = ExtResource("1_ifsfx")

[node name="CollisionPolygon2D" type="CollisionPolygon2D" parent="."]
build_mode = 1
polygon = PackedVector2Array(7, -4, 6, -7, -6, -7, -7, -4, -7, 4, -6, 7, 6, 7, 7, 4)
